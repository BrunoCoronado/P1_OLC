package sistema.analisis;

/*impor java_cup.runtime.Symbol;*/
import sistema.bean.Token;
import main.Main;

%%

%{
    StringBuffer string = new StringBuffer();

    public void addToken(String lexema, String tipo){
        main.Main.tokens.add(new Token(lexema, tipo, yyline, yycolumn));
    }

    public void addError(String lexema, String tipo){
        main.Main.errores.add(new Token(lexema, tipo, yyline, yycolumn));
    }

    public void removerUltimoToken(){
        try{
            main.Main.tokens.remove(main.Main.tokens.size() - 1);
        }catch(Exception ex){}
    }
%}

%class Scanner
%public
%unicode
%full
%char
%line
%column
%ignorecase
/*%cup*/
%standalone

finDeLinea = \r|\n|\r\n
espacioEnBlanco = {finDeLinea} | [ \t\f]
comentarioSTRUCT = "<!" [^*] "!>"
comentario = comentarioSTRUCT
numero = 0 | [1-9][0-9]*

%state ETIQUETA_ABIERTA, COMENTARIO_STRUCT, CIERRE_ETIQUETA_CON_TEXTO, TEXTO_ENTRE_ETIQUETAS, CERRAR_ETIQUETA, ETIQUETA_CUERPO, ATRIBUTOS_ETIQUETA_CUERPO, ETIQUETA_PARRAFO, ATRIBUTOS_ETIQUETA_PARRAFO, ETIQUETA_IMAGEN, ATRIBUTOS_ETIQUETA_IMAGEN, ETIQUETA_BOTON, ATRIBUTOS_ETIQUETA_BOTON, ETIQUETA_TABLA, ETIQUETA_COLUMNAC, TEXTO_ENTRE_ETIQUETASCOLUMNAC, ANALISIS_COLUMNAC

%%

<YYINITIAL>{
    ">"                     { addToken(yytext(), "mayor que"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }                     
    "<"                     { addToken(yytext(), "menor que");  yybegin(ETIQUETA_ABIERTA); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "/"                     { addToken(yytext(), "barra"); yybegin(ETIQUETA_ABIERTA);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    {finDeLinea}            { yychar=1; }
    {espacioEnBlanco}       {  }
    {comentario}            {  }

}

<ETIQUETA_ABIERTA> {
    "!"                     { removerUltimoToken(); yybegin(COMENTARIO_STRUCT); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "/"                     { addToken(yytext(), "barra"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "compi"                 { addToken(yytext(), "Palabra Reservada compi"); yybegin(YYINITIAL); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }                     
    "cabecera"              { addToken(yytext(), "Palabra Reservada cabecera"); yybegin(YYINITIAL); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "titulo"                { addToken(yytext(), "Palabra Reservada titulo"); yybegin(CIERRE_ETIQUETA_CON_TEXTO); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "cuerpo"                { addToken(yytext(), "Palabra Reservada cuerpo"); yybegin(ETIQUETA_CUERPO);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "espacio"               { addToken(yytext(), "Palabra Reservada espacio"); yybegin(YYINITIAL);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "parrafo"               { addToken(yytext(), "Palabra Reservada parrafo"); yybegin(ETIQUETA_PARRAFO);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "salto"                 { addToken(yytext(), "Palabra Reservada salto"); yybegin(YYINITIAL);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "textoa"                { addToken(yytext(), "Palabra Reservada textoa"); yybegin(CIERRE_ETIQUETA_CON_TEXTO);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "textob"                { addToken(yytext(), "Palabra Reservada textob"); yybegin(CIERRE_ETIQUETA_CON_TEXTO);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "imagen"                { addToken(yytext(), "Palabra Reservada imagen"); yybegin(ETIQUETA_IMAGEN); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "boton"                 { addToken(yytext(), "Palabra Reservada boton"); yybegin(ETIQUETA_BOTON);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "tabla"                 { addToken(yytext(), "Palabra Reservada tabla"); yybegin(ETIQUETA_TABLA);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "fila"                  { addToken(yytext(), "Palabra Reservada fila"); yybegin(YYINITIAL);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "columnac"              { addToken(yytext(), "Palabra Reservada columnac"); yybegin(ETIQUETA_COLUMNAC);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "columna"               { addToken(yytext(), "Palabra Reservada columna"); yybegin(ETIQUETA_COLUMNAC);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    {espacioEnBlanco}       {  }
}

<CIERRE_ETIQUETA_CON_TEXTO>{
    ">"                     { addToken(yytext(), "mayor que"); string.setLength(0); yybegin(TEXTO_ENTRE_ETIQUETAS);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }                     
    {espacioEnBlanco}       {  }
}

<TEXTO_ENTRE_ETIQUETAS> {
    "<"                     { addToken(string.toString(), "texto"); addToken(yytext(), "menor que"); yybegin(CERRAR_ETIQUETA); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }                     
    [^\n\r<]+               { string.append( yytext() ); }
    \\t                     { string.append( '\t' ); }
    \\n                     { string.append( '\n' ); }
    \\r                     { string.append( '\r' ); }
    \\\"                    { string.append( '\"' ); }
    \\                      { string.append( '\\' ); }
}

<CERRAR_ETIQUETA> {
    "/"                     { addToken(yytext(), "barra"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "titulo"                { addToken(yytext(), "Palabra Reservada titulo"); yybegin(YYINITIAL); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "parrafo"               { addToken(yytext(), "Palabra Reservada parrafo"); yybegin(YYINITIAL);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "textoa"                { addToken(yytext(), "Palabra Reservada textoa"); yybegin(YYINITIAL);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "textob"                { addToken(yytext(), "Palabra Reservada textob"); yybegin(YYINITIAL);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    {espacioEnBlanco}       {  }
}

//AREA PARA ETIQUETAS CON ATRIBUTOS Y TEXTO ENTRE ETIQUETAS

<ETIQUETA_CUERPO>{
    "="                     { addToken(yytext(), "igual"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "\""                    { addToken(yytext(), "comillas");  string.setLength(0); yybegin(ATRIBUTOS_ETIQUETA_CUERPO); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    ">"                     { addToken(yytext(), "mayor que"); string.setLength(0); yybegin(YYINITIAL);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }                     
    "fondo"                 { addToken(yytext(), "Palabra Reservada fondo"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
}

<ATRIBUTOS_ETIQUETA_CUERPO>{
    "\""                    { addToken(string.toString(), "texto"); addToken(yytext(), "comilla"); yybegin(ETIQUETA_CUERPO);/*yybegin(YYINITIAL); return new Symbol(sym.cadena , yyline , yychar , string.toString());*/ }
    [^\n\r\"\\]+            { string.append( yytext() ); }
    \\t                     { string.append( '\t' ); }
    \\n                     { string.append( '\n' ); }
    \\r                     { string.append( '\r' ); }
    \\\"                    { string.append( '\"' ); }
    \\                      { string.append( '\\' ); }
}

<ETIQUETA_PARRAFO>{
    "="                     { addToken(yytext(), "igual"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "\""                    { addToken(yytext(), "comillas");  string.setLength(0); yybegin(ATRIBUTOS_ETIQUETA_PARRAFO); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "alineacion"            { addToken(yytext(), "Palabra Reservada alineacion");/*return new Symbol(sym. , yyline , yychar , yytext());*/ }    
    ">"                     { addToken(yytext(), "mayor que"); string.setLength(0); yybegin(TEXTO_ENTRE_ETIQUETAS);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }                     
}

<ATRIBUTOS_ETIQUETA_PARRAFO>{
    "\""                    { addToken(yytext(), "comillas"); yybegin(ETIQUETA_PARRAFO);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "izquierda"             { addToken(yytext(), "Palabra Reservada izquierda"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "derecha"               { addToken(yytext(), "Palabra Reservada derecha"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "centrado"              { addToken(yytext(), "Palabra Reservada centrado"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "justificado"           { addToken(yytext(), "Palabra Reservada justificado"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }    
}

<ETIQUETA_IMAGEN>{
    "="                     { addToken(yytext(), "igual"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "\""                    { addToken(yytext(), "comillas");  string.setLength(0); yybegin(ATRIBUTOS_ETIQUETA_IMAGEN); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "path"                  { addToken(yytext(), "Palabra Reservada path"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "alto"                  { addToken(yytext(), "Palabra Reservada alto"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "ancho"                 { addToken(yytext(), "Palabra Reservada ancho"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    ">"                     { addToken(yytext(), "mayor que"); yybegin(YYINITIAL);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }                     
    {numero}                { addToken(yytext(), "numero"); /*return new Symbol(sym.numero , yyline , yychar , yytext());*/ }
}

<ATRIBUTOS_ETIQUETA_IMAGEN>{
    "\""                    { addToken(string.toString(), "texto"); addToken(yytext(), "comilla"); yybegin(ETIQUETA_IMAGEN);/*yybegin(YYINITIAL); return new Symbol(sym.cadena , yyline , yychar , string.toString());*/ }
    [^\n\r\"\\]+            { string.append( yytext() ); }
    \\t                     { string.append( '\t' ); }
    \\n                     { string.append( '\n' ); }
    \\r                     { string.append( '\r' ); }
    \\\"                    { string.append( '\"' ); }
    \\                      { string.append( '\\' ); }
}

<ETIQUETA_BOTON>{
    "="                     { addToken(yytext(), "igual"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "\""                    { addToken(yytext(), "comillas");  string.setLength(0); yybegin(ATRIBUTOS_ETIQUETA_BOTON); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "id"                    { addToken(yytext(), "Palabra Reservada id"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "texto"                 { addToken(yytext(), "Palabra Reservada texto"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    ">"                     { addToken(yytext(), "mayor que"); yybegin(YYINITIAL);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }                     
}

<ATRIBUTOS_ETIQUETA_BOTON>{
    "\""                    { addToken(string.toString(), "texto"); addToken(yytext(), "comilla"); yybegin(ETIQUETA_BOTON);/*yybegin(YYINITIAL); return new Symbol(sym.cadena , yyline , yychar , string.toString());*/ }
    [^\n\r\"\\]+            { string.append( yytext() ); }
    \\t                     { string.append( '\t' ); }
    \\n                     { string.append( '\n' ); }
    \\r                     { string.append( '\r' ); }
    \\\"                    { string.append( '\"' ); }
    \\                      { string.append( '\\' ); }
}

<ETIQUETA_TABLA>{
    "="                     { addToken(yytext(), "igual"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "borde"                 { addToken(yytext(), "Palabra Reservada borde"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "true"                  { addToken(yytext(), "Palabra Reservada true"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "false"                 { addToken(yytext(), "Palabra Reservada false"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    ">"                     { addToken(yytext(), "mayor que"); yybegin(YYINITIAL);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }                     
}

<ETIQUETA_COLUMNAC>{
    ">"                     { addToken(yytext(), "mayor que"); string.setLength(0); yybegin(TEXTO_ENTRE_ETIQUETASCOLUMNAC);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }                     
    {espacioEnBlanco}       {  }
}

<TEXTO_ENTRE_ETIQUETASCOLUMNAC> {
    "<"                     { addToken(string.toString(), "texto"); addToken(yytext(), "menor que"); yybegin(ANALISIS_COLUMNAC); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }                     
    [^\n\r<]+               { string.append( yytext() ); }
    \\t                     { string.append( '\t' ); }
    \\n                     { string.append( '\n' ); }
    \\r                     { string.append( '\r' ); }
    \\\"                    { string.append( '\"' ); }
    \\                      { string.append( '\\' ); }
}

<ANALISIS_COLUMNAC>{
    "/"                     { adETIQUETA_IMAGENdToken(yytext(), "barra"); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "parrafo"               { addToken(yytext(), "Palabra Reservada parrafo"); yybegin(ETIQUETA_PARRAFO);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "salto"                 { addToken(yytext(), "Palabra Reservada salto"); yybegin(YYINITIAL);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "imagen"                { addToken(yytext(), "Palabra Reservada imagen"); yybegin(ETIQUETA_IMAGEN); /*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "boton"                 { addToken(yytext(), "Palabra Reservada boton"); yybegin(ETIQUETA_BOTON);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "columnac"              { addToken(yytext(), "Palabra Reservada columnac"); yybegin(YYINITIAL);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
    "columna"               { addToken(yytext(), "Palabra Reservada columna"); yybegin(YYINITIAL);/*return new Symbol(sym. , yyline , yychar , yytext());*/ }
}

//AREA COMENTARIOS

<COMENTARIO_STRUCT> {
    "!>"                     { yybegin(YYINITIAL); } 
    [^!>]                    {  }
}